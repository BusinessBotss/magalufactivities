<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VIP Bookings Mallorca</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    /* Variables de tema */
    :root { --bg: #000; --text: #fff; --field-bg: rgba(255,255,255,0.1); --border: rgba(255,255,255,0.3); --accent: #ff00cc; }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; font-family: 'Poppins', sans-serif; background: var(--bg); color: var(--text); }
    a { color: var(--text); text-decoration: none; }
    button, input, select, textarea { font-family: inherit; }

    /* Layout */
    .container { width: 90%; max-width: 400px; margin: 2rem auto; display: flex; flex-direction: column; align-items: stretch; animation: fadeInUp 0.6s ease-out; }
    nav { margin-bottom: 1rem; text-align: center; }
    .lang-btn { background: transparent; border: none; color: var(--text); margin: 0 4px; font-weight: 600; cursor: pointer; }
    .lang-btn.active { text-decoration: underline; }

    /* Formulario */
    form[role='form'] { display: flex; flex-direction: column; }
    label { display: block; margin-bottom: 0.25rem; font-weight: 600; opacity: 0.9; }
    .field { margin-bottom: 1rem; position: relative; }
    select, input, textarea { width: 100%; background: var(--field-bg); border: 1px solid var(--border); border-radius: 8px; padding: 0.75rem; color: var(--text); }
    textarea { resize: vertical; min-height: 80px; }
    .tooltip { position: absolute; top: 100%; left: 0; font-size: 0.8rem; opacity: 0.7; margin-top: 0.25rem; }

    /* Ocultar campo */
    .hidden { display: none; }

    /* Botón */
    .btn { border: none; border-radius: 25px; padding: 0.75rem; background: transparent; color: var(--text); font-weight: 600; cursor: pointer; transition: box-shadow 0.3s ease; }
    .btn:disabled { opacity: 0.5; cursor: not-allowed; }
    .btn:hover:not(:disabled) { box-shadow: 0 0 8px var(--accent), 0 0 16px #a100ff; }

    /* Footer */
    footer { margin-top: 2rem; text-align: center; font-size: 0.9rem; opacity: 0.8; }
    footer a { font-weight: 600; }

    /* Estados de Foco */
    input:focus, select:focus, button:focus { outline: 2px solid var(--accent); }

    /* Animaciones */
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px);} to { opacity: 1; transform: translateY(0);} }
  </style>
</head>
<body>
  <div class="container">
    <nav id="lang-switch"></nav>
    
    <p class="intro" id="intro-text"></p>

    <form id="booking-form" role="form">
      <div class="field">
        <label for="service" id="label-service"></label>
        <select id="service" required></select>
      </div>

      <div class="field hidden" id="venue-field">
        <label for="venue" id="label-venue"></label>
        <select id="venue"></select>
      </div>

      <div class="field">
        <label for="participants" id="label-participants"></label>
        <input type="number" id="participants" min="1" value="1" required>
      </div>
      <div class="field">
        <label for="phone" id="label-phone"></label>
        <input type="tel" id="phone" placeholder="+34 600 000 000" required data-tooltip="Formato: +34 600000000">
        <span class="tooltip" id="tip-phone"></span>
      </div>
      <div class="field">
        <label for="notes" id="label-notes"></label>
        <textarea id="notes" placeholder="ej. fecha deseada, preguntas..."></textarea>
      </div>

      <button type="submit" class="btn" id="submit-btn" disabled></button>
      <p id="status-msg" aria-live="polite"></p>
    </form>

    <footer>
      <p id="help-text"></p>
      <p id="disclaimer-text"></p>
    </footer>
  </div>

<script>
(() => {
    const translations = {
        EN: {
            intro: "Book your VIP experience in Mallorca.",
            labels: {
                service: "Select Service",
                venue: "Select Venue",
                participants: "Number of People",
                phone: "Phone Number",
                notes: "Notes (date, questions...)"
            },
            placeholders: {
                service: "-- Choose a service --",
                venue: "-- Choose a venue --"
            },
            services: {
                "Jetski 1h": "Jetski 1h",
                "Boat Rental": "Boat Rental (€400 - €5300/day)",
                "VIP Table": "VIP Table"
            },
            venues: ["BCM", "Lio Mallorca", "Amok"],
            submit: "Book via WhatsApp",
            help: "Need help? Chat with us →",
            disclaimer: "Bookings are pending until confirmed via WhatsApp."
        },
        ES: {
            intro: "Reserva tu experiencia VIP en Mallorca.",
            labels: {
                service: "Selecciona el Servicio",
                venue: "Selecciona la Discoteca",
                participants: "Número de Personas",
                phone: "Número de Teléfono",
                notes: "Notas (fecha deseada, preguntas...)"
            },
            placeholders: {
                service: "-- Elige un servicio --",
                venue: "-- Elige una discoteca --"
            },
            services: {
                "Jetski 1h": "Jetski 1h",
                "Boat Rental": "Alquiler de Barco (400€ - 5300€/día)",
                "VIP Table": "Mesa VIP"
            },
            venues: ["BCM", "Lio Mallorca", "Amok"],
            submit: "Reservar por WhatsApp",
            help: "¿Necesitas ayuda? Habla con nosotros →",
            disclaimer: "Las reservas quedan pendientes hasta su confirmación por WhatsApp."
        }
    };
    const whatsappNumber = "+34644075065"; // Reemplazar con el número real

    const el = {
        langSwitch: document.getElementById('lang-switch'),
        intro: document.getElementById('intro-text'),
        labels: {
            service: document.getElementById('label-service'),
            venue: document.getElementById('label-venue'),
            participants: document.getElementById('label-participants'),
            phone: document.getElementById('label-phone'),
            notes: document.getElementById('label-notes')
        },
        serviceSelect: document.getElementById('service'),
        venueField: document.getElementById('venue-field'),
        venueSelect: document.getElementById('venue'),
        phone: document.getElementById('phone'),
        tipPhone: document.getElementById('tip-phone'),
        submitBtn: document.getElementById('submit-btn'),
        help: document.getElementById('help-text'),
        disclaimer: document.getElementById('disclaimer-text'),
        form: document.getElementById('booking-form')
    };

    let currentLang = localStorage.getItem('lang') || 'ES';

    function init() {
        renderLangButtons();
        applyLanguage(currentLang);
        
        el.form.addEventListener('input', validateForm);
        el.form.addEventListener('submit', onSubmit);
        el.serviceSelect.addEventListener('change', toggleVenueSelector);
        
        el.phone.addEventListener('focus', () => el.tipPhone.textContent = el.phone.dataset.tooltip);
        el.phone.addEventListener('blur', () => el.tipPhone.textContent = '');
    }

    function renderLangButtons() {
        Object.keys(translations).forEach(code => {
            const btn = document.createElement('button');
            btn.textContent = code;
            btn.className = 'lang-btn';
            btn.addEventListener('click', () => {
                currentLang = code;
                localStorage.setItem('lang', code);
                applyLanguage(code);
            });
            el.langSwitch.appendChild(btn);
        });
    }

    function applyLanguage(lang) {
        const t = translations[lang];
        document.documentElement.lang = lang.toLowerCase();
        document.querySelectorAll('.lang-btn').forEach(b => b.classList.toggle('active', b.textContent === lang));

        el.intro.textContent = t.intro;
        Object.keys(el.labels).forEach(key => el.labels[key].textContent = t.labels[key]);
        
        populateSelect(el.serviceSelect, t.placeholders.service, t.services);
        populateSelect(el.venueSelect, t.placeholders.venue, t.venues);

        el.submitBtn.textContent = t.submit;
        el.help.innerHTML = `<a href="https://wa.me/${whatsappNumber}" target="_blank">${t.help}</a>`;
        el.disclaimer.textContent = t.disclaimer;

        // Reset and re-validate after language change
        toggleVenueSelector();
        validateForm();
    }

    function populateSelect(selectEl, placeholder, options) {
        selectEl.innerHTML = `<option value="" disabled selected>${placeholder}</option>`;
        const isObject = !Array.isArray(options);
        for (const key in options) {
            const value = isObject ? key : options[key];
            const text = options[key];
            const option = document.createElement('option');
            option.value = value;
            option.textContent = text;
            selectEl.appendChild(option);
        }
    }

    function toggleVenueSelector() {
        const isVipTable = el.serviceSelect.value === 'VIP Table';
        el.venueField.classList.toggle('hidden', !isVipTable);
        el.venueSelect.required = isVipTable;
        if (!isVipTable) {
            el.venueSelect.value = ''; // Limpiar selección si se cambia de servicio
        }
        validateForm();
    }
    
    function validateForm() {
        const isVipTable = el.serviceSelect.value === 'VIP Table';
        const venueIsValid = !isVipTable || (isVipTable && el.venueSelect.value);
        const formIsValid = el.form.checkValidity() && venueIsValid;
        el.submitBtn.disabled = !formIsValid;
    }

    function onSubmit(e) {
        e.preventDefault();
        const service = el.serviceSelect.options[el.serviceSelect.selectedIndex].text;
        const venue = el.venueSelect.value ? ` en ${el.venueSelect.value}` : '';
        const participants = document.getElementById('participants').value;
        const phone = el.phone.value;
        const notes = document.getElementById('notes').value || 'Ninguna';

        const message = `Hola! Quisiera reservar *${service}${venue}*.\n\n- *Personas:* ${participants}\n- *Teléfono:* ${phone}\n- *Notas:* ${notes}`;

        window.open(`https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`, '_blank');
    }

    document.addEventListener('DOMContentLoaded', init);
})();
</script>
</body>
</html>
